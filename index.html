<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>

    <h3>Take a photo of the QR code</h3>
    <input type="file" name="image" accept="image/*">
    <canvas id="QRCanvas"></canvas>

    <script>
        $('input[name=image]').change(function(e) {
            var file = e.target.files[0];

            // Only process image files
            if (!file.type.match('image.*')) {
                return;
            }

            var reader = new FileReader();

            reader.onloadend = function(e){

                var image = new Image();
                image.onload = function(e){
                    var canvas = document.getElementById("QRCanvas");
                    var context = canvas.getContext("2d");

                    var MAX_WIDTH = 800;
                    var MAX_HEIGHT = 800;
                    var width = image.width;
                    var height = image.height;

                    if (width > height) {
                      if (width > MAX_WIDTH) {
                        height *= MAX_WIDTH / width;
                        width = MAX_WIDTH;
                      }
                    } else {
                      if (height > MAX_HEIGHT) {
                        width *= MAX_HEIGHT / height;
                        height = MAX_HEIGHT;
                      }
                    }
                    canvas.width = width;
                    canvas.height = height;
                    context.drawImage(image, 0, 0, width, height);
                }

                image.src = e.target.result;
            }

            reader.readAsDataURL(file);
        });
    </script>
</body>
</html>